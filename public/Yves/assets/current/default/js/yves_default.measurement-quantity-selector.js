"use strict";
(globalThis["webpackJsonp_yves_default"] = globalThis["webpackJsonp_yves_default"] || []).push([["measurement-quantity-selector"],{

/***/ "./vendor/spryker-shop/product-measurement-unit-widget/src/SprykerShop/Yves/ProductMeasurementUnitWidget/Theme/default/components/molecules/measurement-quantity-selector/measurement-quantity-selector.ts":
/*!*****************************************************************************************************************************************************************************************************************!*\
  !*** ./vendor/spryker-shop/product-measurement-unit-widget/src/SprykerShop/Yves/ProductMeasurementUnitWidget/Theme/default/components/molecules/measurement-quantity-selector/measurement-quantity-selector.ts ***!
  \*****************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ MeasurementQuantitySelector)
/* harmony export */ });
/* harmony import */ var ShopUi_models_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ShopUi/models/component */ "./vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/models/component.ts");
/* eslint-disable max-lines */

/*
 * @tag example This code provides example of using the Product Measurement Unit.
 */


class MeasurementQuantitySelector extends ShopUi_models_component__WEBPACK_IMPORTED_MODULE_0__["default"] {
  constructor() {
    super(...arguments);
    this.qtyInSalesUnitInput = void 0;
    this.qtyInBaseUnitInput = void 0;
    this.measurementUnitInput = void 0;
    this.addToCartButton = void 0;
    this.quantityBetweenUnits = void 0;
    this.minimumQuantity = void 0;
    this.maximumQuantity = void 0;
    this.measurementUnitChoice = void 0;
    this.baseUnit = void 0;
    this.salesUnits = void 0;
    this.currentSalesUnit = void 0;
    this.productQuantityStorage = void 0;
    this.currentValue = void 0;
    this.translations = void 0;
    this.decimals = 4;
    this.factor = 10;
    // eslint-disable-next-line @typescript-eslint/no-magic-numbers
    this.degree = [2, 3];
  }
  readyCallback() {}
  init() {
    this.qtyInSalesUnitInput = this.getElementsByClassName(this.jsName + "__sales-unit-quantity")[0];
    if (!this.qtyInSalesUnitInput) {
      return;
    }
    this.qtyInBaseUnitInput = this.getElementsByClassName(this.jsName + "__base-unit-quantity")[0];
    this.measurementUnitInput = this.getElementsByClassName(this.jsName + "__select-measurement-unit")[0];
    this.addToCartButton = this.getElementsByClassName(this.jsName + "__add-to-cart-button")[0];
    this.quantityBetweenUnits = this.getElementsByClassName(this.jsName + "__quantity-between-units")[0];
    this.minimumQuantity = this.getElementsByClassName(this.jsName + "__minimum-quantity")[0];
    this.maximumQuantity = this.getElementsByClassName(this.jsName + "__maximum-quantity")[0];
    this.measurementUnitChoice = this.getElementsByClassName(this.jsName + "__measurement-unit-choice")[0];
    this.initJson();
    this.initTranslations();
    this.initCurrentSalesUnit();
    this.mapEvents();
  }
  mapEvents() {
    this.qtyInSalesUnitInput.addEventListener('change', () => this.qtyInputChange());
    this.measurementUnitInput.addEventListener('change', event => this.measurementUnitInputChange(event));
  }
  initJson() {
    var measurementUnitData = JSON.parse(this.measurementJSONString);
    this.baseUnit = measurementUnitData.baseUnit;
    this.salesUnits = measurementUnitData.salesUnits;
    this.productQuantityStorage = measurementUnitData.productQuantityStorage;
  }
  initTranslations() {
    this.translations = JSON.parse(this.getElementsByClassName(this.jsName + "__measurement-unit-translation")[0].innerHTML);
  }
  initCurrentSalesUnit() {
    this.salesUnits.forEach(salesUnit => {
      if (salesUnit.is_default) {
        this.currentSalesUnit = salesUnit;
      }
    });
  }
  qtyInputChange(qtyInSalesUnits) {
    if (typeof qtyInSalesUnits === 'undefined') {
      qtyInSalesUnits = +this.qtyInSalesUnitInput.value;
    }
    var error = false;
    var qtyInBaseUnits = this.multiply(qtyInSalesUnits, +this.currentSalesUnit.conversion);
    if ((qtyInBaseUnits - this.getMinQuantity()) % this.getQuantityInterval() !== 0) {
      error = true;
      this.hideNotifications();
      this.quantityBetweenUnits.classList.remove('is-hidden');
    } else if (qtyInBaseUnits < this.getMinQuantity()) {
      error = true;
      this.hideNotifications();
      this.minimumQuantity.classList.remove('is-hidden');
    } else if (this.getMaxQuantity() > 0 && qtyInBaseUnits > this.getMaxQuantity()) {
      error = true;
      this.hideNotifications();
      this.maximumQuantity.classList.remove('is-hidden');
    }
    if (error && !isFinite(qtyInSalesUnits)) {
      this.addToCartButton.setAttribute('disabled', 'disabled');
      this.qtyInSalesUnitInput.setAttribute('disabled', 'disabled');
      return;
    }
    if (error) {
      this.addToCartButton.setAttribute('disabled', 'disabled');
      this.askCustomerForCorrectInput(qtyInSalesUnits);
      return;
    }
    this.qtyInBaseUnitInput.value = qtyInBaseUnits.toString();
    this.addToCartButton.removeAttribute('disabled');
    this.hideNotifications();
  }
  hideNotifications() {
    this.measurementUnitChoice.classList.add('is-hidden');
    this.quantityBetweenUnits.classList.add('is-hidden');
    this.minimumQuantity.classList.add('is-hidden');
    this.maximumQuantity.classList.add('is-hidden');
  }
  askCustomerForCorrectInput(qtyInSalesUnits) {
    var choicesList = this.measurementUnitChoice.getElementsByClassName('list')[0];
    var currentChoice = this.measurementUnitChoice.getElementsByClassName(this.jsName + "__current-choice")[0];
    var minChoice = this.getMinChoice(qtyInSalesUnits);
    var maxChoice = this.getMaxChoice(qtyInSalesUnits, minChoice);
    choicesList.innerHTML = '';
    currentChoice.innerHTML = '';
    currentChoice.textContent = this.round(qtyInSalesUnits, this.decimals) + " " + this.getUnitName(this.currentSalesUnit.product_measurement_unit.code);
    var choiceElements = [];
    choiceElements.push(this.createChoiceElement(minChoice));
    if (maxChoice !== minChoice) {
      choiceElements.push(this.createChoiceElement(maxChoice));
    }
    choiceElements.forEach(element => element !== null ? choicesList.appendChild(element) : undefined);
    this.measurementUnitChoice.classList.remove('is-hidden');
  }
  createChoiceElement(qtyInBaseUnits) {
    if (qtyInBaseUnits > 0) {
      var choiceElem = document.createElement('span');
      var qtyInSalesUnits = qtyInBaseUnits / this.currentSalesUnit.conversion;
      var measurementSalesUnitName = this.getUnitName(this.currentSalesUnit.product_measurement_unit.code);
      var measurementBaseUnitName = this.getUnitName(this.baseUnit.code);
      choiceElem.classList.add('link');
      choiceElem.setAttribute('data-base-unit-qty', qtyInBaseUnits.toString());
      choiceElem.setAttribute('data-sales-unit-qty', qtyInSalesUnits.toString());
      choiceElem.textContent = "(" + this.round(qtyInSalesUnits, this.decimals).toString().toString() + " " + measurementSalesUnitName + ") = (" + qtyInBaseUnits + " " + measurementBaseUnitName + ")";
      choiceElem.onclick = event => {
        var element = event.currentTarget;
        var qtyInBaseUnitsChoice = parseFloat(element.dataset.baseUnitQty);
        var qtyInSalesUnitsChoice = parseFloat(element.dataset.salesUnitQty);
        this.selectQty(qtyInBaseUnitsChoice, qtyInSalesUnitsChoice);
      };
      choiceElem.style.display = 'block';
      return choiceElem;
    }
  }
  selectQty(qtyInBaseUnits, qtyInSalesUnits) {
    this.qtyInBaseUnitInput.value = qtyInBaseUnits.toString();
    this.qtyInSalesUnitInput.value = this.round(qtyInSalesUnits, this.decimals).toString().toString();
    this.addToCartButton.removeAttribute('disabled');
    this.qtyInSalesUnitInput.removeAttribute('disabled');
    this.measurementUnitChoice.classList.add('is-hidden');
  }
  getMinChoice(qtyInSalesUnits) {
    var qtyInBaseUnits = this.floor(this.multiply(qtyInSalesUnits, this.currentSalesUnit.conversion));
    if (qtyInBaseUnits < this.getMinQuantity()) {
      return this.getMinQuantity();
    }
    if ((qtyInBaseUnits - this.getMinQuantity()) % this.getQuantityInterval() !== 0 || this.getMaxQuantity() > 0 && qtyInBaseUnits > this.getMaxQuantity()) {
      return this.getMinChoice((qtyInBaseUnits - 1) / this.currentSalesUnit.conversion);
    }
    return qtyInBaseUnits;
  }
  getMaxChoice(qtyInSalesUnits, minChoice) {
    var qtyInBaseUnits = this.ceil(this.multiply(qtyInSalesUnits, this.currentSalesUnit.conversion));
    if (this.getMaxQuantity() > 0 && qtyInBaseUnits > this.getMaxQuantity()) {
      qtyInBaseUnits = this.getMaxQuantity();
      if ((qtyInBaseUnits - this.getMinQuantity()) % this.getQuantityInterval() !== 0) {
        qtyInBaseUnits = qtyInBaseUnits - (qtyInBaseUnits - this.getMinQuantity()) % this.getQuantityInterval();
      }
      return qtyInBaseUnits;
    }
    if ((qtyInBaseUnits - this.getMinQuantity()) % this.getQuantityInterval() !== 0 || qtyInBaseUnits <= minChoice) {
      return this.getMaxChoice((qtyInBaseUnits + 1) / this.currentSalesUnit.conversion, minChoice);
    }
    return qtyInBaseUnits;
  }
  floor(value) {
    if (Math.floor(value) > 0) {
      return Math.floor(value);
    }
    return Math.ceil(value);
  }
  ceil(value) {
    return Math.ceil(value);
  }
  round(value, decimals) {
    return Number(Math.round(parseFloat(value + "e" + decimals)) + "e-" + decimals);
  }
  multiply(a, b) {
    var result = a * this.factor * (b * this.factor) / Math.pow(this.factor, this.degree[0]);
    return Math.floor(result * Math.pow(this.factor, this.degree[1])) / Math.pow(this.factor, this.degree[1]);
  }
  getMinQuantity() {
    if (typeof this.productQuantityStorage !== 'undefined' && this.productQuantityStorage.hasOwnProperty('quantity_min')) {
      return this.productQuantityStorage.quantity_min;
    }
    return 1;
  }
  getMaxQuantity() {
    if (typeof this.productQuantityStorage !== 'undefined' && this.productQuantityStorage.hasOwnProperty('quantity_max') && this.productQuantityStorage.quantity_max !== null) {
      return this.productQuantityStorage.quantity_max;
    }
    return 0;
  }
  getQuantityInterval() {
    if (typeof this.productQuantityStorage !== 'undefined' && this.productQuantityStorage.hasOwnProperty('quantity_interval')) {
      return this.productQuantityStorage.quantity_interval;
    }
    return 1;
  }
  measurementUnitInputChange(event) {
    var salesUnitId = parseInt(event.currentTarget.value);
    var salesUnit = this.getSalesUnitById(salesUnitId);
    var qtyInSalesUnits = +this.qtyInSalesUnitInput.value;
    var qtyInBaseUnits = this.multiply(qtyInSalesUnits, this.currentSalesUnit.conversion);
    qtyInSalesUnits = qtyInBaseUnits / salesUnit.conversion;
    this.currentSalesUnit = salesUnit;
    if (isFinite(qtyInSalesUnits)) {
      this.qtyInSalesUnitInput.value = this.round(qtyInSalesUnits, this.decimals).toString();
    }
    this.qtyInputChange(qtyInSalesUnits);
  }
  getSalesUnitById(salesUnitId) {
    return this.salesUnits.find(item => salesUnitId === item.id_product_measurement_sales_unit);
  }
  getBaseSalesUnit() {
    return this.salesUnits.find(item => this.baseUnit.id_product_measurement_unit === item.product_measurement_unit.id_product_measurement_unit);
  }
  getUnitName(key) {
    if (this.translations.hasOwnProperty(key)) {
      return this.translations[key];
    }
    return key;
  }
  get measurementJSONString() {
    return this.getAttribute('json');
  }
}

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qcy95dmVzX2RlZmF1bHQubWVhc3VyZW1lbnQtcXVhbnRpdHktc2VsZWN0b3IuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRWdEO0FBMkNqQyxNQUFNQywyQkFBMkIsU0FBU0QsK0RBQVMsQ0FBQztFQUFBRSxZQUFBO0lBQUEsU0FBQUMsU0FBQTtJQUFBLEtBQ3JEQyxtQkFBbUI7SUFBQSxLQUNuQkMsa0JBQWtCO0lBQUEsS0FDbEJDLG9CQUFvQjtJQUFBLEtBQ3BCQyxlQUFlO0lBQUEsS0FDZkMsb0JBQW9CO0lBQUEsS0FDcEJDLGVBQWU7SUFBQSxLQUNmQyxlQUFlO0lBQUEsS0FDZkMscUJBQXFCO0lBQUEsS0FDckJDLFFBQVE7SUFBQSxLQUNSQyxVQUFVO0lBQUEsS0FDVkMsZ0JBQWdCO0lBQUEsS0FDaEJDLHNCQUFzQjtJQUFBLEtBQ3RCQyxZQUFZO0lBQUEsS0FDWkMsWUFBWTtJQUFBLEtBQ0hDLFFBQVEsR0FBRyxDQUFDO0lBQUEsS0FDWkMsTUFBTSxHQUFHLEVBQUU7SUFDOUI7SUFBQSxLQUNtQkMsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztFQUFBO0VBRXhCQyxhQUFhQSxDQUFBLEVBQVMsQ0FBQztFQUV2QkMsSUFBSUEsQ0FBQSxFQUFTO0lBQ25CLElBQUksQ0FBQ2xCLG1CQUFtQixHQUNwQixJQUFJLENBQUNtQixzQkFBc0IsQ0FBSSxJQUFJLENBQUNDLE1BQU0sMEJBQXVCLENBQUMsQ0FBQyxDQUFDLENBQ3ZFO0lBRUQsSUFBSSxDQUFDLElBQUksQ0FBQ3BCLG1CQUFtQixFQUFFO01BQzNCO0lBQ0o7SUFFQSxJQUFJLENBQUNDLGtCQUFrQixHQUNuQixJQUFJLENBQUNrQixzQkFBc0IsQ0FBSSxJQUFJLENBQUNDLE1BQU0seUJBQXNCLENBQUMsQ0FBQyxDQUFDLENBQ3RFO0lBQ0QsSUFBSSxDQUFDbEIsb0JBQW9CLEdBQ3JCLElBQUksQ0FBQ2lCLHNCQUFzQixDQUFJLElB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QixFQUFhO0lBQ3ZELE9BQU8sSUFBSSxDQUFDM0YsVUFBVSxDQUFDOEYsSUFBSSxDQUFFQyxJQUFlLElBQUtKLFdBQVcsS0FBS0ksSUFBSSxDQUFDQyxpQ0FBaUMsQ0FBQztFQUM1RztFQUVVQyxnQkFBZ0JBLENBQUEsRUFBYztJQUNwQyxPQUFPLElBQUksQ0FBQ2pHLFVBQVUsQ0FBQzhGLElBQUksQ0FDdEJDLElBQWUsSUFDWixJQUFJLENBQUNoRyxRQUFRLENBQUNtRywyQkFBMkIsS0FBS0gsSUFBSSxDQUFDeEMsd0JBQXdCLENBQUMyQywyQkFDcEYsQ0FBQztFQUNMO0VBRVU1QyxXQUFXQSxDQUFDNkMsR0FBVyxFQUFVO0lBQ3ZDLElBQUksSUFBSSxDQUFDL0YsWUFBWSxDQUFDbUYsY0FBYyxDQUFDWSxHQUFHLENBQUMsRUFBRTtNQUN2QyxPQUFPLElBQUksQ0FBQy9GLFlBQVksQ0FBQytGLEdBQUcsQ0FBQztJQUNqQztJQUVBLE9BQU9BLEdBQUc7RUFDZDtFQUVBLElBQWM1RSxxQkFBcUJBLENBQUEsRUFBVztJQUMxQyxPQUFPLElBQUksQ0FBQzZFLFlBQVksQ0FBQyxNQUFNLENBQUM7RUFDcEM7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL3NwcnlrZXItYjJiLWRlbW8tc2hvcC8uL3ZlbmRvci9zcHJ5a2VyLXNob3AvcHJvZHVjdC1tZWFzdXJlbWVudC11bml0LXdpZGdldC9zcmMvU3ByeWtlclNob3AvWXZlcy9Qcm9kdWN0TWVhc3VyZW1lbnRVbml0V2lkZ2V0L1RoZW1lL2RlZmF1bHQvY29tcG9uZW50cy9tb2xlY3VsZXMvbWVhc3VyZW1lbnQtcXVhbnRpdHktc2VsZWN0b3IvbWVhc3VyZW1lbnQtcXVhbnRpdHktc2VsZWN0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbWF4LWxpbmVzICovXG5cbi8qXG4gKiBAdGFnIGV4YW1wbGUgVGhpcyBjb2RlIHByb3ZpZGVzIGV4YW1wbGUgb2YgdXNpbmcgdGhlIFByb2R1Y3QgTWVhc3VyZW1lbnQgVW5pdC5cbiAqL1xuXG5pbXBvcnQgQ29tcG9uZW50IGZyb20gJ1Nob3BVaS9tb2RlbHMvY29tcG9uZW50JztcblxuaW50ZXJmYWNlIFVuaXRUcmFuc2xhdGlvbnNKU09ORGF0YSB7XG4gICAgZ3JhbTogc3RyaW5nO1xuICAgIGl0ZW06IHN0cmluZztcbiAgICBraWxvOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBCYXNlVW5pdCB7XG4gICAgY29kZTogc3RyaW5nO1xuICAgIGRlZmF1bHRfcHJlY2lzaW9uOiBudW1iZXI7XG4gICAgaWRfcHJvZHVjdF9tZWFzdXJlbWVudF91bml0OiBudW1iZXI7XG4gICAgbmFtZTogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU2FsZXNVbml0IHtcbiAgICBjb252ZXJzaW9uOiBudW1iZXI7XG4gICAgZmtfcHJvZHVjdDogbnVtYmVyO1xuICAgIGZrX3Byb2R1Y3RfbWVhc3VyZW1lbnRfYmFzZV91bml0PzogbnVtYmVyO1xuICAgIGZrX3Byb2R1Y3RfbWVhc3VyZW1lbnRfdW5pdD86IG51bWJlcjtcbiAgICBpZF9wcm9kdWN0X21lYXN1cmVtZW50X3NhbGVzX3VuaXQ6IG51bWJlcjtcbiAgICBpc19kZWZhdWx0OiBib29sZWFuO1xuICAgIGlzX2Rpc3BsYXllZDogYm9vbGVhbjtcbiAgICBwcmVjaXNpb246IG51bWJlcjtcbiAgICBwcm9kdWN0X21lYXN1cmVtZW50X2Jhc2VfdW5pdD86IG51bWJlcjtcbiAgICBwcm9kdWN0X21lYXN1cmVtZW50X3VuaXQ6IEJhc2VVbml0O1xuICAgIHN0b3JlX3JlbGF0aW9uPzogbnVtYmVyO1xuICAgIHZhbHVlPzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgUHJvZHVjdFF1YW50aXR5U3RvcmFnZSB7XG4gICAgaWRfcHJvZHVjdDogbnVtYmVyO1xuICAgIHF1YW50aXR5X2ludGVydmFsPzogbnVtYmVyO1xuICAgIHF1YW50aXR5X21heD86IG51bWJlcjtcbiAgICBxdWFudGl0eV9taW4/OiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBNZWFzdXJlbWVudEpTT05EYXRhIHtcbiAgICBiYXNlVW5pdDogQmFzZVVuaXQ7XG4gICAgc2FsZXNVbml0czogU2FsZXNVbml0W107XG4gICAgcHJvZHVjdFF1YW50aXR5U3RvcmFnZTogUHJvZHVjdFF1YW50aXR5U3RvcmFnZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWVhc3VyZW1lbnRRdWFudGl0eVNlbGVjdG9yIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICBwcm90ZWN0ZWQgcXR5SW5TYWxlc1VuaXRJbnB1dDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgcXR5SW5CYXNlVW5pdElucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHByb3RlY3RlZCBtZWFzdXJlbWVudFVuaXRJbnB1dDogSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgcHJvdGVjdGVkIGFkZFRvQ2FydEJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJvdGVjdGVkIHF1YW50aXR5QmV0d2VlblVuaXRzOiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgbWluaW11bVF1YW50aXR5OiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgbWF4aW11bVF1YW50aXR5OiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgbWVhc3VyZW1lbnRVbml0Q2hvaWNlOiBIVE1MRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgYmFzZVVuaXQ6IEJhc2VVbml0O1xuICAgIHByb3RlY3RlZCBzYWxlc1VuaXRzOiBTYWxlc1VuaXRbXTtcbiAgICBwcm90ZWN0ZWQgY3VycmVudFNhbGVzVW5pdDogU2FsZXNVbml0O1xuICAgIHByb3RlY3RlZCBwcm9kdWN0UXVhbnRpdHlTdG9yYWdlOiBQcm9kdWN0UXVhbnRpdHlTdG9yYWdlO1xuICAgIHByb3RlY3RlZCBjdXJyZW50VmFsdWU6IG51bWJlcjtcbiAgICBwcm90ZWN0ZWQgdHJhbnNsYXRpb25zOiBVbml0VHJhbnNsYXRpb25zSlNPTkRhdGE7XG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGRlY2ltYWxzID0gNDtcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgZmFjdG9yID0gMTA7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1tYWdpYy1udW1iZXJzXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGRlZ3JlZSA9IFsyLCAzXTtcblxuICAgIHByb3RlY3RlZCByZWFkeUNhbGxiYWNrKCk6IHZvaWQge31cblxuICAgIHByb3RlY3RlZCBpbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLnF0eUluU2FsZXNVbml0SW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD4oXG4gICAgICAgICAgICB0aGlzLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYCR7dGhpcy5qc05hbWV9X19zYWxlcy11bml0LXF1YW50aXR5YClbMF1cbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoIXRoaXMucXR5SW5TYWxlc1VuaXRJbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5xdHlJbkJhc2VVbml0SW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD4oXG4gICAgICAgICAgICB0aGlzLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYCR7dGhpcy5qc05hbWV9X19iYXNlLXVuaXQtcXVhbnRpdHlgKVswXVxuICAgICAgICApO1xuICAgICAgICB0aGlzLm1lYXN1cmVtZW50VW5pdElucHV0ID0gPEhUTUxTZWxlY3RFbGVtZW50PihcbiAgICAgICAgICAgIHRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShgJHt0aGlzLmpzTmFtZX1fX3NlbGVjdC1tZWFzdXJlbWVudC11bml0YClbMF1cbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5hZGRUb0NhcnRCdXR0b24gPSA8SFRNTEJ1dHRvbkVsZW1lbnQ+dGhpcy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGAke3RoaXMuanNOYW1lfV9fYWRkLXRvLWNhcnQtYnV0dG9uYClbMF07XG4gICAgICAgIHRoaXMucXVhbnRpdHlCZXR3ZWVuVW5pdHMgPSA8SFRNTEVsZW1lbnQ+KFxuICAgICAgICAgICAgdGhpcy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGAke3RoaXMuanNOYW1lfV9fcXVhbnRpdHktYmV0d2Vlbi11bml0c2ApWzBdXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMubWluaW11bVF1YW50aXR5ID0gPEhUTUxFbGVtZW50PnRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShgJHt0aGlzLmpzTmFtZX1fX21pbmltdW0tcXVhbnRpdHlgKVswXTtcbiAgICAgICAgdGhpcy5tYXhpbXVtUXVhbnRpdHkgPSA8SFRNTEVsZW1lbnQ+dGhpcy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGAke3RoaXMuanNOYW1lfV9fbWF4aW11bS1xdWFudGl0eWApWzBdO1xuICAgICAgICB0aGlzLm1lYXN1cmVtZW50VW5pdENob2ljZSA9IDxIVE1MRWxlbWVudD4oXG4gICAgICAgICAgICB0aGlzLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYCR7dGhpcy5qc05hbWV9X19tZWFzdXJlbWVudC11bml0LWNob2ljZWApWzBdXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5pbml0SnNvbigpO1xuICAgICAgICB0aGlzLmluaXRUcmFuc2xhdGlvbnMoKTtcbiAgICAgICAgdGhpcy5pbml0Q3VycmVudFNhbGVzVW5pdCgpO1xuICAgICAgICB0aGlzLm1hcEV2ZW50cygpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBtYXBFdmVudHMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucXR5SW5TYWxlc1VuaXRJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB0aGlzLnF0eUlucHV0Q2hhbmdlKCkpO1xuICAgICAgICB0aGlzLm1lYXN1cmVtZW50VW5pdElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChldmVudDogRXZlbnQpID0+IHRoaXMubWVhc3VyZW1lbnRVbml0SW5wdXRDaGFuZ2UoZXZlbnQpKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgaW5pdEpzb24oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1lYXN1cmVtZW50VW5pdERhdGEgPSA8TWVhc3VyZW1lbnRKU09ORGF0YT5KU09OLnBhcnNlKHRoaXMubWVhc3VyZW1lbnRKU09OU3RyaW5nKTtcblxuICAgICAgICB0aGlzLmJhc2VVbml0ID0gbWVhc3VyZW1lbnRVbml0RGF0YS5iYXNlVW5pdDtcbiAgICAgICAgdGhpcy5zYWxlc1VuaXRzID0gbWVhc3VyZW1lbnRVbml0RGF0YS5zYWxlc1VuaXRzO1xuICAgICAgICB0aGlzLnByb2R1Y3RRdWFudGl0eVN0b3JhZ2UgPSBtZWFzdXJlbWVudFVuaXREYXRhLnByb2R1Y3RRdWFudGl0eVN0b3JhZ2U7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGluaXRUcmFuc2xhdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudHJhbnNsYXRpb25zID0gPFVuaXRUcmFuc2xhdGlvbnNKU09ORGF0YT4oXG4gICAgICAgICAgICBKU09OLnBhcnNlKHRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShgJHt0aGlzLmpzTmFtZX1fX21lYXN1cmVtZW50LXVuaXQtdHJhbnNsYXRpb25gKVswXS5pbm5lckhUTUwpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGluaXRDdXJyZW50U2FsZXNVbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLnNhbGVzVW5pdHMuZm9yRWFjaCgoc2FsZXNVbml0OiBTYWxlc1VuaXQpID0+IHtcbiAgICAgICAgICAgIGlmIChzYWxlc1VuaXQuaXNfZGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNhbGVzVW5pdCA9IHNhbGVzVW5pdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHF0eUlucHV0Q2hhbmdlKHF0eUluU2FsZXNVbml0cz86IG51bWJlcik6IHZvaWQge1xuICAgICAgICBpZiAodHlwZW9mIHF0eUluU2FsZXNVbml0cyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHF0eUluU2FsZXNVbml0cyA9ICt0aGlzLnF0eUluU2FsZXNVbml0SW5wdXQudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGVycm9yID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHF0eUluQmFzZVVuaXRzID0gdGhpcy5tdWx0aXBseShxdHlJblNhbGVzVW5pdHMsICt0aGlzLmN1cnJlbnRTYWxlc1VuaXQuY29udmVyc2lvbik7XG4gICAgICAgIGlmICgocXR5SW5CYXNlVW5pdHMgLSB0aGlzLmdldE1pblF1YW50aXR5KCkpICUgdGhpcy5nZXRRdWFudGl0eUludGVydmFsKCkgIT09IDApIHtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuaGlkZU5vdGlmaWNhdGlvbnMoKTtcbiAgICAgICAgICAgIHRoaXMucXVhbnRpdHlCZXR3ZWVuVW5pdHMuY2xhc3NMaXN0LnJlbW92ZSgnaXMtaGlkZGVuJyk7XG4gICAgICAgIH0gZWxzZSBpZiAocXR5SW5CYXNlVW5pdHMgPCB0aGlzLmdldE1pblF1YW50aXR5KCkpIHtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuaGlkZU5vdGlmaWNhdGlvbnMoKTtcbiAgICAgICAgICAgIHRoaXMubWluaW11bVF1YW50aXR5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWhpZGRlbicpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZ2V0TWF4UXVhbnRpdHkoKSA+IDAgJiYgcXR5SW5CYXNlVW5pdHMgPiB0aGlzLmdldE1heFF1YW50aXR5KCkpIHtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuaGlkZU5vdGlmaWNhdGlvbnMoKTtcbiAgICAgICAgICAgIHRoaXMubWF4aW11bVF1YW50aXR5LmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWhpZGRlbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVycm9yICYmICFpc0Zpbml0ZShxdHlJblNhbGVzVW5pdHMpKSB7XG4gICAgICAgICAgICB0aGlzLmFkZFRvQ2FydEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB0aGlzLnF0eUluU2FsZXNVbml0SW5wdXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkVG9DYXJ0QnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIHRoaXMuYXNrQ3VzdG9tZXJGb3JDb3JyZWN0SW5wdXQocXR5SW5TYWxlc1VuaXRzKTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5xdHlJbkJhc2VVbml0SW5wdXQudmFsdWUgPSBxdHlJbkJhc2VVbml0cy50b1N0cmluZygpO1xuICAgICAgICB0aGlzLmFkZFRvQ2FydEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgIHRoaXMuaGlkZU5vdGlmaWNhdGlvbnMoKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgaGlkZU5vdGlmaWNhdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMubWVhc3VyZW1lbnRVbml0Q2hvaWNlLmNsYXNzTGlzdC5hZGQoJ2lzLWhpZGRlbicpO1xuICAgICAgICB0aGlzLnF1YW50aXR5QmV0d2VlblVuaXRzLmNsYXNzTGlzdC5hZGQoJ2lzLWhpZGRlbicpO1xuICAgICAgICB0aGlzLm1pbmltdW1RdWFudGl0eS5jbGFzc0xpc3QuYWRkKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgdGhpcy5tYXhpbXVtUXVhbnRpdHkuY2xhc3NMaXN0LmFkZCgnaXMtaGlkZGVuJyk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGFza0N1c3RvbWVyRm9yQ29ycmVjdElucHV0KHF0eUluU2FsZXNVbml0czogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNob2ljZXNMaXN0ID0gdGhpcy5tZWFzdXJlbWVudFVuaXRDaG9pY2UuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbGlzdCcpWzBdO1xuICAgICAgICBjb25zdCBjdXJyZW50Q2hvaWNlID0gdGhpcy5tZWFzdXJlbWVudFVuaXRDaG9pY2UuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShgJHt0aGlzLmpzTmFtZX1fX2N1cnJlbnQtY2hvaWNlYClbMF07XG4gICAgICAgIGNvbnN0IG1pbkNob2ljZSA9IHRoaXMuZ2V0TWluQ2hvaWNlKHF0eUluU2FsZXNVbml0cyk7XG4gICAgICAgIGNvbnN0IG1heENob2ljZSA9IHRoaXMuZ2V0TWF4Q2hvaWNlKHF0eUluU2FsZXNVbml0cywgbWluQ2hvaWNlKTtcbiAgICAgICAgY2hvaWNlc0xpc3QuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIGN1cnJlbnRDaG9pY2UuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIGN1cnJlbnRDaG9pY2UudGV4dENvbnRlbnQgPSBgJHt0aGlzLnJvdW5kKHF0eUluU2FsZXNVbml0cywgdGhpcy5kZWNpbWFscyl9ICR7dGhpcy5nZXRVbml0TmFtZShcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNhbGVzVW5pdC5wcm9kdWN0X21lYXN1cmVtZW50X3VuaXQuY29kZSxcbiAgICAgICAgKX1gO1xuXG4gICAgICAgIGNvbnN0IGNob2ljZUVsZW1lbnRzID0gW107XG4gICAgICAgIGNob2ljZUVsZW1lbnRzLnB1c2godGhpcy5jcmVhdGVDaG9pY2VFbGVtZW50KG1pbkNob2ljZSkpO1xuICAgICAgICBpZiAobWF4Q2hvaWNlICE9PSBtaW5DaG9pY2UpIHtcbiAgICAgICAgICAgIGNob2ljZUVsZW1lbnRzLnB1c2godGhpcy5jcmVhdGVDaG9pY2VFbGVtZW50KG1heENob2ljZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hvaWNlRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4gKGVsZW1lbnQgIT09IG51bGwgPyBjaG9pY2VzTGlzdC5hcHBlbmRDaGlsZChlbGVtZW50KSA6IHVuZGVmaW5lZCkpO1xuXG4gICAgICAgIHRoaXMubWVhc3VyZW1lbnRVbml0Q2hvaWNlLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWhpZGRlbicpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBjcmVhdGVDaG9pY2VFbGVtZW50KHF0eUluQmFzZVVuaXRzOiBudW1iZXIpOiBIVE1MU3BhbkVsZW1lbnQge1xuICAgICAgICBpZiAocXR5SW5CYXNlVW5pdHMgPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBjaG9pY2VFbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAgICAgY29uc3QgcXR5SW5TYWxlc1VuaXRzID0gcXR5SW5CYXNlVW5pdHMgLyB0aGlzLmN1cnJlbnRTYWxlc1VuaXQuY29udmVyc2lvbjtcbiAgICAgICAgICAgIGNvbnN0IG1lYXN1cmVtZW50U2FsZXNVbml0TmFtZSA9IHRoaXMuZ2V0VW5pdE5hbWUodGhpcy5jdXJyZW50U2FsZXNVbml0LnByb2R1Y3RfbWVhc3VyZW1lbnRfdW5pdC5jb2RlKTtcbiAgICAgICAgICAgIGNvbnN0IG1lYXN1cmVtZW50QmFzZVVuaXROYW1lID0gdGhpcy5nZXRVbml0TmFtZSh0aGlzLmJhc2VVbml0LmNvZGUpO1xuXG4gICAgICAgICAgICBjaG9pY2VFbGVtLmNsYXNzTGlzdC5hZGQoJ2xpbmsnKTtcbiAgICAgICAgICAgIGNob2ljZUVsZW0uc2V0QXR0cmlidXRlKCdkYXRhLWJhc2UtdW5pdC1xdHknLCBxdHlJbkJhc2VVbml0cy50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGNob2ljZUVsZW0uc2V0QXR0cmlidXRlKCdkYXRhLXNhbGVzLXVuaXQtcXR5JywgcXR5SW5TYWxlc1VuaXRzLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgY2hvaWNlRWxlbS50ZXh0Q29udGVudCA9IGAoJHt0aGlzLnJvdW5kKHF0eUluU2FsZXNVbml0cywgdGhpcy5kZWNpbWFscylcbiAgICAgICAgICAgICAgICAudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgIC50b1N0cmluZygpfSAke21lYXN1cmVtZW50U2FsZXNVbml0TmFtZX0pID0gKCR7cXR5SW5CYXNlVW5pdHN9ICR7bWVhc3VyZW1lbnRCYXNlVW5pdE5hbWV9KWA7XG4gICAgICAgICAgICBjaG9pY2VFbGVtLm9uY2xpY2sgPSAoZXZlbnQ6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IDxIVE1MU2VsZWN0RWxlbWVudD5ldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICAgICAgICAgIGNvbnN0IHF0eUluQmFzZVVuaXRzQ2hvaWNlID0gcGFyc2VGbG9hdChlbGVtZW50LmRhdGFzZXQuYmFzZVVuaXRRdHkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHF0eUluU2FsZXNVbml0c0Nob2ljZSA9IHBhcnNlRmxvYXQoZWxlbWVudC5kYXRhc2V0LnNhbGVzVW5pdFF0eSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RRdHkocXR5SW5CYXNlVW5pdHNDaG9pY2UsIHF0eUluU2FsZXNVbml0c0Nob2ljZSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjaG9pY2VFbGVtLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXG4gICAgICAgICAgICByZXR1cm4gY2hvaWNlRWxlbTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBzZWxlY3RRdHkocXR5SW5CYXNlVW5pdHM6IG51bWJlciwgcXR5SW5TYWxlc1VuaXRzOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5xdHlJbkJhc2VVbml0SW5wdXQudmFsdWUgPSBxdHlJbkJhc2VVbml0cy50b1N0cmluZygpO1xuICAgICAgICB0aGlzLnF0eUluU2FsZXNVbml0SW5wdXQudmFsdWUgPSB0aGlzLnJvdW5kKHF0eUluU2FsZXNVbml0cywgdGhpcy5kZWNpbWFscykudG9TdHJpbmcoKS50b1N0cmluZygpO1xuICAgICAgICB0aGlzLmFkZFRvQ2FydEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgIHRoaXMucXR5SW5TYWxlc1VuaXRJbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgIHRoaXMubWVhc3VyZW1lbnRVbml0Q2hvaWNlLmNsYXNzTGlzdC5hZGQoJ2lzLWhpZGRlbicpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRNaW5DaG9pY2UocXR5SW5TYWxlc1VuaXRzOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBjb25zdCBxdHlJbkJhc2VVbml0cyA9IHRoaXMuZmxvb3IodGhpcy5tdWx0aXBseShxdHlJblNhbGVzVW5pdHMsIHRoaXMuY3VycmVudFNhbGVzVW5pdC5jb252ZXJzaW9uKSk7XG5cbiAgICAgICAgaWYgKHF0eUluQmFzZVVuaXRzIDwgdGhpcy5nZXRNaW5RdWFudGl0eSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRNaW5RdWFudGl0eSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgKHF0eUluQmFzZVVuaXRzIC0gdGhpcy5nZXRNaW5RdWFudGl0eSgpKSAlIHRoaXMuZ2V0UXVhbnRpdHlJbnRlcnZhbCgpICE9PSAwIHx8XG4gICAgICAgICAgICAodGhpcy5nZXRNYXhRdWFudGl0eSgpID4gMCAmJiBxdHlJbkJhc2VVbml0cyA+IHRoaXMuZ2V0TWF4UXVhbnRpdHkoKSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRNaW5DaG9pY2UoKHF0eUluQmFzZVVuaXRzIC0gMSkgLyB0aGlzLmN1cnJlbnRTYWxlc1VuaXQuY29udmVyc2lvbik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcXR5SW5CYXNlVW5pdHM7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldE1heENob2ljZShxdHlJblNhbGVzVW5pdHM6IG51bWJlciwgbWluQ2hvaWNlOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBsZXQgcXR5SW5CYXNlVW5pdHMgPSB0aGlzLmNlaWwodGhpcy5tdWx0aXBseShxdHlJblNhbGVzVW5pdHMsIHRoaXMuY3VycmVudFNhbGVzVW5pdC5jb252ZXJzaW9uKSk7XG5cbiAgICAgICAgaWYgKHRoaXMuZ2V0TWF4UXVhbnRpdHkoKSA+IDAgJiYgcXR5SW5CYXNlVW5pdHMgPiB0aGlzLmdldE1heFF1YW50aXR5KCkpIHtcbiAgICAgICAgICAgIHF0eUluQmFzZVVuaXRzID0gdGhpcy5nZXRNYXhRdWFudGl0eSgpO1xuXG4gICAgICAgICAgICBpZiAoKHF0eUluQmFzZVVuaXRzIC0gdGhpcy5nZXRNaW5RdWFudGl0eSgpKSAlIHRoaXMuZ2V0UXVhbnRpdHlJbnRlcnZhbCgpICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcXR5SW5CYXNlVW5pdHMgPVxuICAgICAgICAgICAgICAgICAgICBxdHlJbkJhc2VVbml0cyAtICgocXR5SW5CYXNlVW5pdHMgLSB0aGlzLmdldE1pblF1YW50aXR5KCkpICUgdGhpcy5nZXRRdWFudGl0eUludGVydmFsKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcXR5SW5CYXNlVW5pdHM7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICAocXR5SW5CYXNlVW5pdHMgLSB0aGlzLmdldE1pblF1YW50aXR5KCkpICUgdGhpcy5nZXRRdWFudGl0eUludGVydmFsKCkgIT09IDAgfHxcbiAgICAgICAgICAgIHF0eUluQmFzZVVuaXRzIDw9IG1pbkNob2ljZVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE1heENob2ljZSgocXR5SW5CYXNlVW5pdHMgKyAxKSAvIHRoaXMuY3VycmVudFNhbGVzVW5pdC5jb252ZXJzaW9uLCBtaW5DaG9pY2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHF0eUluQmFzZVVuaXRzO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBmbG9vcih2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKE1hdGguZmxvb3IodmFsdWUpID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IodmFsdWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbCh2YWx1ZSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNlaWwodmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwodmFsdWUpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCByb3VuZCh2YWx1ZTogbnVtYmVyLCBkZWNpbWFsczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE51bWJlcihgJHtNYXRoLnJvdW5kKHBhcnNlRmxvYXQoYCR7dmFsdWV9ZSR7ZGVjaW1hbHN9YCkpfWUtJHtkZWNpbWFsc31gKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgbXVsdGlwbHkoYTogbnVtYmVyLCBiOiBudW1iZXIpOiBudW1iZXIge1xuICAgICAgICBjb25zdCByZXN1bHQgPSAoYSAqIHRoaXMuZmFjdG9yICogKGIgKiB0aGlzLmZhY3RvcikpIC8gTWF0aC5wb3codGhpcy5mYWN0b3IsIHRoaXMuZGVncmVlWzBdKTtcblxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihyZXN1bHQgKiBNYXRoLnBvdyh0aGlzLmZhY3RvciwgdGhpcy5kZWdyZWVbMV0pKSAvIE1hdGgucG93KHRoaXMuZmFjdG9yLCB0aGlzLmRlZ3JlZVsxXSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldE1pblF1YW50aXR5KCk6IG51bWJlciB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHR5cGVvZiB0aGlzLnByb2R1Y3RRdWFudGl0eVN0b3JhZ2UgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICAgICB0aGlzLnByb2R1Y3RRdWFudGl0eVN0b3JhZ2UuaGFzT3duUHJvcGVydHkoJ3F1YW50aXR5X21pbicpXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvZHVjdFF1YW50aXR5U3RvcmFnZS5xdWFudGl0eV9taW47XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZ2V0TWF4UXVhbnRpdHkoKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdHlwZW9mIHRoaXMucHJvZHVjdFF1YW50aXR5U3RvcmFnZSAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgICAgIHRoaXMucHJvZHVjdFF1YW50aXR5U3RvcmFnZS5oYXNPd25Qcm9wZXJ0eSgncXVhbnRpdHlfbWF4JykgJiZcbiAgICAgICAgICAgIHRoaXMucHJvZHVjdFF1YW50aXR5U3RvcmFnZS5xdWFudGl0eV9tYXggIT09IG51bGxcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9kdWN0UXVhbnRpdHlTdG9yYWdlLnF1YW50aXR5X21heDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRRdWFudGl0eUludGVydmFsKCk6IG51bWJlciB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHR5cGVvZiB0aGlzLnByb2R1Y3RRdWFudGl0eVN0b3JhZ2UgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgICAgICB0aGlzLnByb2R1Y3RRdWFudGl0eVN0b3JhZ2UuaGFzT3duUHJvcGVydHkoJ3F1YW50aXR5X2ludGVydmFsJylcbiAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9kdWN0UXVhbnRpdHlTdG9yYWdlLnF1YW50aXR5X2ludGVydmFsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG1lYXN1cmVtZW50VW5pdElucHV0Q2hhbmdlKGV2ZW50OiBFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBzYWxlc1VuaXRJZCA9IHBhcnNlSW50KCg8SFRNTFNlbGVjdEVsZW1lbnQ+ZXZlbnQuY3VycmVudFRhcmdldCkudmFsdWUpO1xuICAgICAgICBjb25zdCBzYWxlc1VuaXQgPSB0aGlzLmdldFNhbGVzVW5pdEJ5SWQoc2FsZXNVbml0SWQpO1xuICAgICAgICBsZXQgcXR5SW5TYWxlc1VuaXRzID0gK3RoaXMucXR5SW5TYWxlc1VuaXRJbnB1dC52YWx1ZTtcbiAgICAgICAgY29uc3QgcXR5SW5CYXNlVW5pdHMgPSB0aGlzLm11bHRpcGx5KHF0eUluU2FsZXNVbml0cywgdGhpcy5jdXJyZW50U2FsZXNVbml0LmNvbnZlcnNpb24pO1xuICAgICAgICBxdHlJblNhbGVzVW5pdHMgPSBxdHlJbkJhc2VVbml0cyAvIHNhbGVzVW5pdC5jb252ZXJzaW9uO1xuICAgICAgICB0aGlzLmN1cnJlbnRTYWxlc1VuaXQgPSBzYWxlc1VuaXQ7XG5cbiAgICAgICAgaWYgKGlzRmluaXRlKHF0eUluU2FsZXNVbml0cykpIHtcbiAgICAgICAgICAgIHRoaXMucXR5SW5TYWxlc1VuaXRJbnB1dC52YWx1ZSA9IHRoaXMucm91bmQocXR5SW5TYWxlc1VuaXRzLCB0aGlzLmRlY2ltYWxzKS50b1N0cmluZygpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5xdHlJbnB1dENoYW5nZShxdHlJblNhbGVzVW5pdHMpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRTYWxlc1VuaXRCeUlkKHNhbGVzVW5pdElkOiBudW1iZXIpOiBTYWxlc1VuaXQge1xuICAgICAgICByZXR1cm4gdGhpcy5zYWxlc1VuaXRzLmZpbmQoKGl0ZW06IFNhbGVzVW5pdCkgPT4gc2FsZXNVbml0SWQgPT09IGl0ZW0uaWRfcHJvZHVjdF9tZWFzdXJlbWVudF9zYWxlc191bml0KTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZ2V0QmFzZVNhbGVzVW5pdCgpOiBTYWxlc1VuaXQge1xuICAgICAgICByZXR1cm4gdGhpcy5zYWxlc1VuaXRzLmZpbmQoXG4gICAgICAgICAgICAoaXRlbTogU2FsZXNVbml0KSA9PlxuICAgICAgICAgICAgICAgIHRoaXMuYmFzZVVuaXQuaWRfcHJvZHVjdF9tZWFzdXJlbWVudF91bml0ID09PSBpdGVtLnByb2R1Y3RfbWVhc3VyZW1lbnRfdW5pdC5pZF9wcm9kdWN0X21lYXN1cmVtZW50X3VuaXQsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldFVuaXROYW1lKGtleTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKHRoaXMudHJhbnNsYXRpb25zLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRyYW5zbGF0aW9uc1trZXldO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGtleTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZ2V0IG1lYXN1cmVtZW50SlNPTlN0cmluZygpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoJ2pzb24nKTtcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiQ29tcG9uZW50IiwiTWVhc3VyZW1lbnRRdWFudGl0eVNlbGVjdG9yIiwiY29uc3RydWN0b3IiLCJhcmd1bWVudHMiLCJxdHlJblNhbGVzVW5pdElucHV0IiwicXR5SW5CYXNlVW5pdElucHV0IiwibWVhc3VyZW1lbnRVbml0SW5wdXQiLCJhZGRUb0NhcnRCdXR0b24iLCJxdWFudGl0eUJldHdlZW5Vbml0cyIsIm1pbmltdW1RdWFudGl0eSIsIm1heGltdW1RdWFudGl0eSIsIm1lYXN1cmVtZW50VW5pdENob2ljZSIsImJhc2VVbml0Iiwic2FsZXNVbml0cyIsImN1cnJlbnRTYWxlc1VuaXQiLCJwcm9kdWN0UXVhbnRpdHlTdG9yYWdlIiwiY3VycmVudFZhbHVlIiwidHJhbnNsYXRpb25zIiwiZGVjaW1hbHMiLCJmYWN0b3IiLCJkZWdyZWUiLCJyZWFkeUNhbGxiYWNrIiwiaW5pdCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJqc05hbWUiLCJpbml0SnNvbiIsImluaXRUcmFuc2xhdGlvbnMiLCJpbml0Q3VycmVudFNhbGVzVW5pdCIsIm1hcEV2ZW50cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJxdHlJbnB1dENoYW5nZSIsImV2ZW50IiwibWVhc3VyZW1lbnRVbml0SW5wdXRDaGFuZ2UiLCJtZWFzdXJlbWVudFVuaXREYXRhIiwiSlNPTiIsInBhcnNlIiwibWVhc3VyZW1lbnRKU09OU3RyaW5nIiwiaW5uZXJIVE1MIiwiZm9yRWFjaCIsInNhbGVzVW5pdCIsImlzX2RlZmF1bHQiLCJxdHlJblNhbGVzVW5pdHMiLCJ2YWx1ZSIsImVycm9yIiwicXR5SW5CYXNlVW5pdHMiLCJtdWx0aXBseSIsImNvbnZlcnNpb24iLCJnZXRNaW5RdWFudGl0eSIsImdldFF1YW50aXR5SW50ZXJ2YWwiLCJoaWRlTm90aWZpY2F0aW9ucyIsImNsYXNzTGlzdCIsInJlbW92ZSIsImdldE1heFF1YW50aXR5IiwiaXNGaW5pdGUiLCJzZXRBdHRyaWJ1dGUiLCJhc2tDdXN0b21lckZvckNvcnJlY3RJbnB1dCIsInRvU3RyaW5nIiwicmVtb3ZlQXR0cmlidXRlIiwiYWRkIiwiY2hvaWNlc0xpc3QiLCJjdXJyZW50Q2hvaWNlIiwibWluQ2hvaWNlIiwiZ2V0TWluQ2hvaWNlIiwibWF4Q2hvaWNlIiwiZ2V0TWF4Q2hvaWNlIiwidGV4dENvbnRlbnQiLCJyb3VuZCIsImdldFVuaXROYW1lIiwicHJvZHVjdF9tZWFzdXJlbWVudF91bml0IiwiY29kZSIsImNob2ljZUVsZW1lbnRzIiwicHVzaCIsImNyZWF0ZUNob2ljZUVsZW1lbnQiLCJlbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJ1bmRlZmluZWQiLCJjaG9pY2VFbGVtIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwibWVhc3VyZW1lbnRTYWxlc1VuaXROYW1lIiwibWVhc3VyZW1lbnRCYXNlVW5pdE5hbWUiLCJvbmNsaWNrIiwiY3VycmVudFRhcmdldCIsInF0eUluQmFzZVVuaXRzQ2hvaWNlIiwicGFyc2VGbG9hdCIsImRhdGFzZXQiLCJiYXNlVW5pdFF0eSIsInF0eUluU2FsZXNVbml0c0Nob2ljZSIsInNhbGVzVW5pdFF0eSIsInNlbGVjdFF0eSIsInN0eWxlIiwiZGlzcGxheSIsImZsb29yIiwiY2VpbCIsIk1hdGgiLCJOdW1iZXIiLCJhIiwiYiIsInJlc3VsdCIsInBvdyIsImhhc093blByb3BlcnR5IiwicXVhbnRpdHlfbWluIiwicXVhbnRpdHlfbWF4IiwicXVhbnRpdHlfaW50ZXJ2YWwiLCJzYWxlc1VuaXRJZCIsInBhcnNlSW50IiwiZ2V0U2FsZXNVbml0QnlJZCIsImZpbmQiLCJpdGVtIiwiaWRfcHJvZHVjdF9tZWFzdXJlbWVudF9zYWxlc191bml0IiwiZ2V0QmFzZVNhbGVzVW5pdCIsImlkX3Byb2R1Y3RfbWVhc3VyZW1lbnRfdW5pdCIsImtleSIsImdldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=